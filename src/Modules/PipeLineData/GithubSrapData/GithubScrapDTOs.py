from marshmallow import Schema, fields, validate, post_dump
from src.Helpers.Utils import CamelCaseSchema

class GithubRepositoryDTO(CamelCaseSchema):
    id = fields.Str(dump_only=True)
    github_profile_id = fields.Str(dump_only=True)
    name = fields.Str(required=True)
    full_name = fields.Str(required=True)
    description = fields.Str(allow_none=True)
    homepage = fields.Str(allow_none=True)
    language = fields.Str(allow_none=True)
    stars = fields.Int(dump_only=True)
    watchers = fields.Int(dump_only=True)
    forks = fields.Int(dump_only=True)
    open_issues = fields.Int(dump_only=True)
    size = fields.Int(dump_only=True)
    created_at = fields.DateTime(allow_none=True)
    updated_at = fields.DateTime(allow_none=True)
    pushed_at = fields.DateTime(allow_none=True)
    is_fork = fields.Bool(dump_only=True)

    languages_breakdown = fields.Dict(keys=fields.Str(), values=fields.Int(), allow_none=True)
    stats = fields.Dict(allow_none=True)
    dates = fields.Dict(allow_none=True)
    urls = fields.Dict(allow_none=True)
    features = fields.Dict(allow_none=True)
    branch = fields.Dict(allow_none=True)
    license = fields.Str(allow_none=True)
    latest_commits = fields.List(fields.Dict, allow_none=True)
    top_contributors = fields.List(fields.Dict, allow_none=True)

class GitHubProfileDTO(CamelCaseSchema):
    id = fields.Str(dump_only=True)
    candidate_id = fields.Str(required=True)
    username = fields.Str(required=True)
    name = fields.Str(allow_none=True)
    email = fields.Str(allow_none=True)
    bio = fields.Str(allow_none=True)
    company = fields.Str(allow_none=True)
    location = fields.Str(allow_none=True)
    blog = fields.Str(allow_none=True)
    twitter_username = fields.Str(allow_none=True)
    avatar_url = fields.Str(allow_none=True)
    followers = fields.Int(dump_only=True)
    following = fields.Int(dump_only=True)
    public_repos = fields.Int(dump_only=True)
    public_gists = fields.Int(dump_only=True)
    total_stars_earned = fields.Int(dump_only=True)
    contributions_last_year = fields.Int(dump_only=True)
    rating = fields.Str(allow_none=True)
    created_at = fields.DateTime(allow_none=True)
    updated_at = fields.DateTime(allow_none=True)

    stats = fields.Dict(allow_none=True)
    dates = fields.Dict(allow_none=True)
    urls = fields.Dict(allow_none=True)
    additional_info = fields.Dict(allow_none=True)

    repositories = fields.Nested(GithubRepositoryDTO, many=True)